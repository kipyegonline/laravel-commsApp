_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[27],{"27FL":function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/issues",function(){return n("dIDr")}])},SBsC:function(e,t,n){"use strict";var a=n("o0o1"),r=n.n(a),s=n("HaE+"),i=n("vDqi"),u=n.n(i),o=n("tm1B");function l(){return(l=Object(s.a)(r.a.mark((function e(t,n){var a,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.a.get(t);case 3:if(!(null===(s=e.sent)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.length)&&!Array.isArray(s.data)){e.next=8;break}n(o.a(s.data)),e.next=9;break;case 8:throw new Error("No data found...");case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),n(o.g(e.t0.message));case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}t.a=function(e,t){return l.apply(this,arguments)}},dIDr:function(e,t,n){"use strict";n.r(t);var a=n("ODXe"),r=n("q1tI"),s=n.n(r),i=n("vDqi"),u=n.n(i),o=n("7Cbv"),l=n("/MKj"),c=n("tRbT"),d=n("R/WZ"),m=n("ofer"),f=n("iae6"),p=n("hlFM"),v=n("Z3vd"),g=n("ADg1"),h=n("Spdj"),y=n("r9w1"),b=n("eD//"),x=n("tVbE"),N=n("IsqK"),w=n("56Ss"),j=n("ZiQX"),I=n("3Qh7"),O=n("l1im"),k=n("L6Je"),_=n("t6oH"),E=(n("7pcq"),n("lMTm")),S=n("tm1B"),D=n("SBsC"),C=(n("9jvC"),s.a.createElement),T=Object(d.a)({form:{padding:"1rem",margin:"1rem 0",maxWidth:500,background:"#fff"}}),A=5;var R=function(e){var t=e.sendValue,n=void 0===t?function(e){return e}:t,r=e.userdept,i=void 0===r?{}:r,l=e.sendSelected,c=void 0===l?function(e){return e}:l,d=s.a.useState(""),m=Object(a.a)(d,2),f=m[0],p=m[1],b=s.a.useState(""),x=Object(a.a)(b,2),N=x[0],w=x[1],j=s.a.useState(""),I=Object(a.a)(j,2),O=I[0],k=I[1],_=T(),E=s.a.useRef(null),S=s.a.useRef(null);return C("div",null,C("form",{className:_.form,ref:E,onSubmit:function(e){e.preventDefault(),i.id?f.trimRight().length<5?(w("Please type the issue"),setTimeout((function(){return w("")}),3e3)):f.trimRight().length>4&&(null===i||void 0===i?void 0:i.id.length)>0&&(S.current.disabled=!0,n({issue:f,altId:Object(o.a)(),userdept:i.id}),u.a.post("/issues/add/true",{issue:f,altId:Object(o.a)(),userdept:i.id}).then((function(e){if(console.log(e),c(""),200!==e.status)throw new Error(e.msg);k(e.msg),p("")})).catch((function(e){w(e.message)})).finally((function(){setTimeout((function(){E.current.reset(),k(""),S.current.disabled=!1}),3e3)}))):(w("Please click on the department"),setTimeout((function(){return w("")}),3e3))}},C("p",null,"Add issues for ",i.altName||""," department"),C(g.a,null,C(h.a,{className:"text-danger my-2"},i.altName||""," "),C(y.a,{label:"Add issue(s)",autoFocus:!0,onChange:function(e){return p(e.target.value)},value:f,variant:"outlined"})),C("div",{className:"form-group"},C(h.a,{error:!0,className:"my-1"},N),C(h.a,{className:"my-1 text-success"},O)),C(v.a,{color:"secondary",type:"submit",size:"medium",variant:"contained",ref:S},"Add Issue")))},q=function(e){var t=e.issues,n=void 0===t?[]:t,r=e.deleteId,i=void 0===r?function(e){return e}:r,o=s.a.useState(0),l=Object(a.a)(o,2),c=l[0],d=l[1],m=Math.ceil(n.length/10),f=10*c,p=10*c+10;return C(s.a.Fragment,null,C(b.a,{dense:!0},n.slice(f,p).map((function(e,t){return C(x.a,{key:e.altId,divider:!0,alignItems:"flex-start"},C("small",null,f+t+1),C(N.a,{primary:e.issue,secondary:e.altId}),C(w.a,null,C(I.a,{onClick:function(){return t=e.altId,void(confirm("Delete items?")&&(i(t),u.a.get("/issues/delete/".concat(t)).then((function(e){return console.log(e)})).then((function(e){return console.log(e)})).catch((function(e){return e}))));var t}})))}))),C(O.a,{count:m,defaultValue:c+1,color:"primary",onChange:function(e,t){return d(t-1)},className:"my-2"}))};t.default=function(){var e=Object(l.b)(),t=(T(),s.a.useState(!0)),n=Object(a.a)(t,2),r=n[0],i=n[1],o=Object(l.c)((function(e){return{issues:null===e||void 0===e?void 0:e.issues.addedIssues,departments:null===e||void 0===e?void 0:e.departments.departments,depterr:null===e||void 0===e?void 0:e.departments.errorMsg,dept:null===e||void 0===e?void 0:e.departments.dept}})),d=o.issues,g=o.departments,h=o.depterr,y=o.dept;return s.a.useEffect((function(){return u.a.get("/issues/fetchall/true").then((function(t){e(E.b(t.data)),e(S.d(A)),e(E.h(A)),e(S.f(A))})).catch((function(e){return console.log(e,"fetch error")})).finally((function(){return i(!1)})),g.length||Object(D.a)("/departments/fetchdepts",e),function(){return e(S.e())}}),[]),C(k.a,null,C(c.a,{alignItems:"flex-start",container:!0,justify:"space-evenly",spacing:4,direction:"row"},C(c.a,{cols:5,item:!0,component:"div",xs:!0},C(R,{sendValue:function(t){e(E.d(t))},userdept:y})),C(c.a,{item:!0,xs:!0},g.length?C(_.b,{depts:g,getDept:function(t){S.d(t),e(S.d(t.id)),e(E.h(t.id))}}):h?C("div",{className:"mx-auto my-4 text-center p-4"},C(j.a,{severity:"error"},C(m.a,{align:"center"},h))):C("div",{className:"mx-auto my-4 p-4 text-center"},C(f.a,{color:"primary",size:"3rem"}),C(m.a,null,"Loading departments"))),C(c.a,{item:!0,xs:!0},C(p.a,{className:"block my-2"},d.length?C("div",null,C(m.a,{variant:"body2",className:"alert alert-primary text-center p-2 my-2"},y.department||""),C(q,{issues:d,deleteId:function(t){e(E.f(t))}})):r?C("div",{className:"mx-auto my-4 text-center"},C(f.a,{size:"3rem",color:"primary"})):C("div",{className:"mx-auto my-4 p-4 text-center"},C(j.a,{severity:"error"}," ",C("p",null,"No issues found for this ",y.department,"."))," "),g.length?C(v.a,{variant:"outlined",color:"secondary",onClick:function(){e(E.g()),e(S.e())}},"View all issues"):null))))}}},[["27FL",0,1,11,2,3,4,5,6,7,8,9,10,15]]]);