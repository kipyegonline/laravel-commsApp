_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[28],{"27FL":function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/issues",function(){return n("dIDr")}])},dIDr:function(e,t,n){"use strict";n.r(t);var a=n("ODXe"),s=n("q1tI"),r=n.n(s),u=n("EVdn"),i=n.n(u),c=n("vDqi"),l=n.n(c),o=n("7Cbv"),d=n("/MKj"),m=n("tRbT"),f=n("R/WZ"),p=n("hlFM"),h=n("Z3vd"),g=n("ADg1"),v=n("Spdj"),b=n("r9w1"),y=n("eD//"),j=n("tVbE"),w=n("IsqK"),I=n("56Ss"),N=n("3Qh7"),O=n("l1im"),_=n("L6Je"),x=n("t6oH"),E=(n("7pcq"),n("lMTm")),S=n("tm1B"),D=(n("9jvC"),r.a.createElement),T=Object(f.a)({form:{padding:"1rem",margin:"1rem 0",maxWidth:500,background:"#fff"}}),k=5;var C=function(e){var t=e.sendValue,n=void 0===t?function(e){return e}:t,s=e.userdept,u=void 0===s?{}:s,c=e.sendSelected,l=void 0===c?function(e){return e}:c,d=r.a.useState(""),m=Object(a.a)(d,2),f=m[0],p=m[1],y=r.a.useState(""),j=Object(a.a)(y,2),w=j[0],I=j[1],N=r.a.useState(""),O=Object(a.a)(N,2),_=O[0],x=O[1],E=T(),S=r.a.useRef(null),k=r.a.useRef(null);return D("div",null,D("form",{className:E.form,ref:S,onSubmit:function(e){e.preventDefault(),u.id?f.trimRight().length<5?(I("Please type the issue"),setTimeout((function(){return I("")}),3e3)):f.trimRight().length>4&&u.id.length>0&&(k.current.disabled=!0,n({issue:f,altId:Object(o.a)(),userdept:u.id}),i.a.ajax({url:"/issues?add=true",data:{issue:f,altId:Object(o.a)(),userdept:u.id},type:"POST",dataType:"json"}).then((function(e){if(l(""),200!==e.status)throw new Error(e.msg);x(e.msg),p("")})).catch((function(e){I(e.message)})).finally((function(){setTimeout((function(){S.current.reset(),x(""),k.current.disabled=!1}),3e3)}))):(I("Please click on the department"),setTimeout((function(){return I("")}),3e3))}},D("p",null,"Add issues for ",u.altName||""," department"),D(g.a,null,D(v.a,{className:"text-danger my-2"},u.altName||""," "),D(b.a,{label:"Add issue(s)",autoFocus:!0,onChange:function(e){return p(e.target.value)},value:f,variant:"outlined"})),D("div",{className:"form-group"},D(v.a,{error:!0,className:"my-1"},w),D(v.a,{className:"my-1 text-success"},_)),D(h.a,{color:"secondary",type:"submit",size:"medium",variant:"contained",ref:k},"Add Issue")))},R=function(e){var t=e.issues,n=void 0===t?[]:t,s=e.deleteId,u=void 0===s?function(e){return e}:s,i=r.a.useState(0),c=Object(a.a)(i,2),l=c[0],o=c[1],d=Math.ceil(n.length/10),m=10*l,f=10*l+10;return D(r.a.Fragment,null,D(y.a,{dense:!0},n.slice(m,f).map((function(e,t){return D(j.a,{key:e.altId,divider:!0,alignItems:"flex-start"},D("small",null,m+t+1),D(w.a,{primary:e.issue,secondary:e.altId}),D(I.a,null,D(N.a,{onClick:function(){return t=e.altId,void(confirm("Delete items?")&&(u(t),fetch("/issues?delete=".concat(t)).then((function(e){return e.json()})).then((function(e){return console.log(e)})).catch((function(e){return e}))));var t}})))}))),D(O.a,{count:d,defaultValue:l+1,color:"primary",onChange:function(e,t){return o(t-1)},className:"my-2"}))};t.default=function(){var e=Object(d.b)(),t=(T(),r.a.useState({})),n=Object(a.a)(t,2),s=n[0],u=n[1],i=Object(d.c)((function(e){return{issues:e.issues.addedIssues,departments:e.departments.departments}})),c=i.issues,o=i.departments;return r.a.useEffect((function(){l.a.get("/issues/fetchall").then((function(t){return e(E.b(t.data))})).catch((function(e){return console.log(e,"fetch error")})),e(S.d(k)),e(E.h(k))}),[]),D(_.a,null,D(m.a,{alignItems:"flex-start",container:!0,justify:"space-evenly",spacing:4,direction:"row"},D(m.a,{cols:5,item:!0,component:"div",xs:!0},D(C,{sendValue:function(t){e(E.d(t))},userdept:s})),D(m.a,{item:!0,xs:!0},D(x.b,{depts:o,getDept:function(t){u(t),e(S.d(t.id)),e(E.h(t.id))}})),D(m.a,{item:!0,xs:!0},D(p.a,null,D("small",{className:"alert alert-primary text-center p-2 my-2"},s.department||""),D(R,{issues:c,deleteId:function(t){l.a.get("/issues?delete=".concat(t)),e(E.f(t))}}),o.length?D(h.a,{variant:"outlined",color:"secondary",onClick:function(){return e(E.g())}},"View all issues"):null))))}}},[["27FL",0,1,9,2,3,4,5,6,7,8,10,11,15]]]);