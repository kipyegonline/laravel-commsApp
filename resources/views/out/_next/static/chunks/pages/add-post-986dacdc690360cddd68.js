_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[23],{"4VTM":function(e,t,r){"use strict";r.r(t);var n=r("KQm4"),o=r("rePB"),a=r("ODXe"),i=r("q1tI"),s=r.n(i),c=r("/MKj"),p=r("R/WZ"),u=r("EVdn"),l=r.n(u),d=r("7Cbv"),f=r("tRbT"),m=r("ADg1"),h=r("1AYd"),g=r("pdwK"),b=r("r9w1"),y=r("Spdj"),v=r("Z3vd"),j=r("30+C"),O=r("hlFM"),w=r("LYUY"),x=Object(w.a)(s.a.createElement("path",{d:"M12 7c-.55 0-1 .45-1 1v3H8c-.55 0-1 .45-1 1s.45 1 1 1h3v3c0 .55.45 1 1 1s1-.45 1-1v-3h3c.55 0 1-.45 1-1s-.45-1-1-1h-3V8c0-.55-.45-1-1-1zm0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"AddCircleOutlineRounded"),N=r("L6Je"),C=r("t6oH"),E=r("5jqn"),P=r("tm1B"),S=r("lMTm"),K=r("9jvC"),R=s.a.createElement;function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){Object(o.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var A=Object(p.a)({grid:{minWidth:300},root:{width:"90%",margin:".5rem auto",border:"1px solid red",padding:"1rem"},textarea:{width:"80",margin:"1rem auto",borderRadius:10},formControl:{width:"100%"},input:{padding:"0.15rem",width:"100%",margin:"0.25rem 0.15rem"}}),I=20;t.default=function(){var e=s.a.useState(""),t=Object(a.a)(e,2),r=t[0],o=t[1],i=s.a.useState(""),p=Object(a.a)(i,2),u=p[0],w=p[1],T=s.a.useState(""),_=Object(a.a)(T,2),z=_[0],L=_[1],U=s.a.useState(""),B=Object(a.a)(U,2),F=B[0],V=B[1],M=s.a.useState(""),W=Object(a.a)(M,2),H=W[0],q=W[1],Y=s.a.useState([]),G=Object(a.a)(Y,2),J=G[0],X=G[1],Q=s.a.useState([]),Z=Object(a.a)(Q,2),$=Z[0],ee=Z[1],te=s.a.useState(""),re=Object(a.a)(te,2),ne=re[0],oe=re[1],ae=s.a.useState([]),ie=Object(a.a)(ae,2),se=ie[0],ce=ie[1],pe=s.a.useState(""),ue=Object(a.a)(pe,2),le=ue[0],de=ue[1],fe=s.a.useState(""),me=Object(a.a)(fe,2),he=me[0],ge=me[1],be=s.a.useRef(null),ye=s.a.useRef(null),ve=Object(c.c)((function(e){return{issues:e.issues.fetched,selectedUsers:e.users.selectedUsers,departments:e.departments.departments}})),je=ve.issues,Oe=ve.selectedUsers,we=ve.departments,xe=Object(c.b)(),Ne=A(),Ce=new Date;s.a.useEffect((function(){console.log("Effect, client Dept"),window.addEventListener("unload",(function(){console.log("Dom unloading")}),[se]),window.addEventListener("load",(function(){console.log("Dom loaded")}))}),[]);var Ee=[];return R(N.a,null,R(O.a,{className:Ne.root},R("form",{className:"form",ref:be,onSubmit:function(e){if(e.preventDefault(),r.trim().length<6)de("Kindly add a client or company name");else if(J.length<1)de("Kindly select the nature of issue");else if(ne.trim().length<6)de("Kindly add the subject of the issue");else if(H.trim().length<10)de("Kindly provide a brief description of the issue");else if(se.length<1)de("Please click on  the department to handle issue");else if($.length<1)de("Please click on the officer(s) to handle issue");else if(r.trim().length>5&&J.length>0&&ne.trim().length>5&&H.trim().length>9&&se.length>0&&$.length>0){de(""),ye.current.disabled=!0,function(e,t){e.forEach((function(e){var r=t.find((function(t){return t.userdept===e.userdept}));if(r){var o=e.id+"-"+r.id;Ee=[].concat(Object(n.a)(Ee),[D(D({},e),{},{id:o})])}}))}($,je);var t={clientName:r,clientPhone:u,clientEmail:z,clientOrg:F,message:H,handler:Ee.map((function(e){return e.id})).join("*"),subject:ne,clientDept:se.join("*"),addedBy:I,status:0,altId:Object(d.a)(),addedon:(new Date).toLocaleString()};console.log("dara",Ee,t),Object(K.b)(t,"posts"),l.a.ajax({url:"./server/posts/posts.php?addposts=true",dataType:"json",cache:!1,type:"post",data:t}).then((function(e){if(console.log("res",e),200!==e.status)throw new Error(e.msg);ge(e.msg),setTimeout((function(){xe(E.j([])),xe(P.e([])),xe(S.k([])),ge(),o(""),w(""),L(""),V(""),q(""),X([]),ee([]),oe(""),ce([]),Ee=[],be.current.reset(),ye.current.disabled=!1}),2e3)})).catch((function(e){ye.current.disabled=!1,console.log("BBC",e,e.statusText,e.message)}))}else de("Kindly ensure name,type of issue,subject,message,department and officer in-charge fields are not empty")}},R("h5",{className:"text-center alert alert-info p-2 my-2"},"Add new issue - ",Ce.toDateString()),R(f.a,{container:!0,justify:"space-evenly",alignItems:"flex-start"},R(f.a,{item:!0,xs:!0,className:"my-3 p-2 card w-100 ".concat(Ne.grid),style:{border:"1px solid yellow"}},R("p",{className:"text-center"},"Customer details"),R(m.a,{className:Ne.formControl},R(h.a,{htmlFor:"client-name"},"Enter Name"),R(g.a,{type:"text",onChange:function(e){return o(e.target.value)},id:"client-name",variant:"outlined"})),R(m.a,{className:Ne.formControl},R(h.a,{htmlFor:"client-phone"},"Enter Phone"),R(g.a,{type:"telephone",onChange:function(e){return w(e.target.value)},id:"client-phone",variant:"outlined",className:Ne.input})),R(m.a,{className:Ne.formControl},R(h.a,{htmlFor:"client"},"Enter email"),R(g.a,{type:"email",onChange:function(e){return L(e.target.value)},id:"client-email",label:"Enter email",className:Ne.input,variant:"outlined"})),R(m.a,{className:Ne.formControl},R(h.a,{htmlFor:"client"},"Enter Organisation"),R(g.a,{type:"text",onChange:function(e){return V(e.target.value)},id:"client-org",label:"Organisation",variant:"outlined",className:Ne.input})),je.length>0?R(C.d,{getIssue:function(e){if(e.length>J.length){var t=e[e.length-1],r=je.find((function(e){return e.id===t}));if(r)je.some((function(e){return e.userdept===r.userdept&&e.selected}))?alert("Cannot select 2 issues from same department, split the post into 2"):(xe(S.e(t)),X(e))}else J.forEach((function(t){e.indexOf(t)<0&&xe(S.j(t.id))})),X(e)},issue:J,issues:je,multiple:!0}):null,R(b.a,{label:"subject",variant:"outlined",onChange:function(e){return oe(e.target.value)},fullWidth:!0,className:Ne.textarea}),R(b.a,{variant:"outlined",label:"Add Description",onChange:function(e){return q(e.target.value)},rows:3,size:"medium",focused:!0,fullWidth:!0,multiline:!0,className:Ne.textarea}),R(y.a,{error:!0},le),R(y.a,{className:"alert alert-success"},he),R(v.a,{color:"primary",size:"large",variant:"outlined",type:"submit",ref:ye,startIcon:R(x,null)},"Post Issue")),R(f.a,{item:!0,xs:!0,className:Ne.grid},R(C.b,{depts:we,getDept:function(e){if(se.includes(e.id))se.splice(se.indexOf(e.id),1);else{var t=e.id;ce([].concat(Object(n.a)(se),[t]))}var r=e.selected;xe(P.c(e.id)),r?(xe(E.i(e.id)),xe(S.i(e.id)),ee($.filter((function(t){return t.userdept!==e.id})))):(function(e){fetch("./server/users/users.php?fetchSelectedUsers=true&id=".concat(e)).then((function(e){return e.json()})).then((function(e){if(e.length>0)return e.map((function(e){return D(D({},e),{},{selected:!1})}));throw new Error("No payload")})).then((function(e){return xe(E.e(e))})).catch((function(e){return console.log("fetch users error",e)}))}(e.id),function(e){fetch("./server/issues/issues.php?fetchSelectedIssue=true&id=".concat(e)).then((function(e){return e.json()})).then((function(e){if(e.length>0){var t=e.map((function(e){return D(D({},e),{},{selected:!1})}));xe(S.c(t))}throw new Error("No payload")})).catch((function(e){return console.log("fetch issue error",e)}))}(e.id))}}),R(j.a,null,R("small",null,"Selected departments"),R(k,{depts:we}))),R(f.a,{item:!0,xs:!0,className:Ne.grid},Oe.length>0?R(C.c,{users:Oe,getUser:function(e){if($.find((function(t){return t.id===e.id}))){var t=$.findIndex((function(t){return t.id===e.id}));$.splice(t,1),xe(E.g(e.id))}else{$.some((function(t){return t.userdept===e.userdept}))?alert("Cannot add 2 users from the same department"):(ee([].concat(Object(n.a)($),[e])),xe(E.g(e.id)))}}}):R("p",{className:"text-center"},"Click on department to load users"))))))};var k=function(e){return e.depts.filter((function(e){return e.selected})).map((function(e,t){return R(y.a,{key:e.id},t+1,".",e.altName)}))}},"7Cbv":function(e,t,r){"use strict";var n="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),o=new Uint8Array(16);function a(){if(!n)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(o)}for(var i=[],s=0;s<256;++s)i.push((s+256).toString(16).substr(1));var c=function(e,t){var r=t||0,n=i;return(n[e[r+0]]+n[e[r+1]]+n[e[r+2]]+n[e[r+3]]+"-"+n[e[r+4]]+n[e[r+5]]+"-"+n[e[r+6]]+n[e[r+7]]+"-"+n[e[r+8]]+n[e[r+9]]+"-"+n[e[r+10]]+n[e[r+11]]+n[e[r+12]]+n[e[r+13]]+n[e[r+14]]+n[e[r+15]]).toLowerCase()};t.a=function(e,t,r){"string"===typeof e&&(t="binary"===e?new Uint8Array(16):null,e=null);var n=(e=e||{}).random||(e.rng||a)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){for(var o=r||0,i=0;i<16;++i)t[o+i]=n[i];return t}return c(n)}},LYUY:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("wx14"),o=r("q1tI"),a=r.n(o),i=r("HR5l");function s(e,t){var r=a.a.memo(a.a.forwardRef((function(t,r){return a.a.createElement(i.a,Object(n.a)({ref:r},t),e)})));return r.muiName=i.a.muiName,r}},hlFM:function(e,t,r){"use strict";var n=r("KQm4"),o=r("wx14"),a=(r("17x9"),r("bv9d"));var i=function(e){var t=function(t){var r=e(t);return t.css?Object(o.a)(Object(o.a)({},Object(a.a)(r,e(Object(o.a)({theme:t.theme},t.css)))),function(e,t){var r={};return Object.keys(e).forEach((function(n){-1===t.indexOf(n)&&(r[n]=e[n])})),r}(t.css,[e.filterProps])):r};return t.propTypes={},t.filterProps=["css"].concat(Object(n.a)(e.filterProps)),t};var s=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=function(e){return t.reduce((function(t,r){var n=r(e);return n?Object(a.a)(t,n):t}),{})};return n.propTypes={},n.filterProps=t.reduce((function(e,t){return e.concat(t.filterProps)}),[]),n},c=r("rePB"),p=r("LybE");function u(e,t){return t&&"string"===typeof t?t.split(".").reduce((function(e,t){return e&&e[t]?e[t]:null}),e):null}var l=function(e){var t=e.prop,r=e.cssProperty,n=void 0===r?e.prop:r,o=e.themeKey,a=e.transform,i=function(e){if(null==e[t])return null;var r=e[t],i=u(e.theme,o)||{};return Object(p.a)(e,r,(function(e){var t;return"function"===typeof i?t=i(e):Array.isArray(i)?t=i[e]||e:(t=u(i,e)||e,a&&(t=a(t))),!1===n?t:Object(c.a)({},n,t)}))};return i.propTypes={},i.filterProps=[t],i};function d(e){return"number"!==typeof e?e:"".concat(e,"px solid")}var f=s(l({prop:"border",themeKey:"borders",transform:d}),l({prop:"borderTop",themeKey:"borders",transform:d}),l({prop:"borderRight",themeKey:"borders",transform:d}),l({prop:"borderBottom",themeKey:"borders",transform:d}),l({prop:"borderLeft",themeKey:"borders",transform:d}),l({prop:"borderColor",themeKey:"palette"}),l({prop:"borderRadius",themeKey:"shape"})),m=s(l({prop:"displayPrint",cssProperty:!1,transform:function(e){return{"@media print":{display:e}}}}),l({prop:"display"}),l({prop:"overflow"}),l({prop:"textOverflow"}),l({prop:"visibility"}),l({prop:"whiteSpace"})),h=s(l({prop:"flexBasis"}),l({prop:"flexDirection"}),l({prop:"flexWrap"}),l({prop:"justifyContent"}),l({prop:"alignItems"}),l({prop:"alignContent"}),l({prop:"order"}),l({prop:"flex"}),l({prop:"flexGrow"}),l({prop:"flexShrink"}),l({prop:"alignSelf"}),l({prop:"justifyItems"}),l({prop:"justifySelf"})),g=s(l({prop:"gridGap"}),l({prop:"gridColumnGap"}),l({prop:"gridRowGap"}),l({prop:"gridColumn"}),l({prop:"gridRow"}),l({prop:"gridAutoFlow"}),l({prop:"gridAutoColumns"}),l({prop:"gridAutoRows"}),l({prop:"gridTemplateColumns"}),l({prop:"gridTemplateRows"}),l({prop:"gridTemplateAreas"}),l({prop:"gridArea"})),b=s(l({prop:"position"}),l({prop:"zIndex",themeKey:"zIndex"}),l({prop:"top"}),l({prop:"right"}),l({prop:"bottom"}),l({prop:"left"})),y=s(l({prop:"color",themeKey:"palette"}),l({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette"})),v=l({prop:"boxShadow",themeKey:"shadows"});function j(e){return e<=1?"".concat(100*e,"%"):e}var O=l({prop:"width",transform:j}),w=l({prop:"maxWidth",transform:j}),x=l({prop:"minWidth",transform:j}),N=l({prop:"height",transform:j}),C=l({prop:"maxHeight",transform:j}),E=l({prop:"minHeight",transform:j}),P=(l({prop:"size",cssProperty:"width",transform:j}),l({prop:"size",cssProperty:"height",transform:j}),s(O,w,x,N,C,E,l({prop:"boxSizing"}))),S=r("+Hmc"),K=s(l({prop:"fontFamily",themeKey:"typography"}),l({prop:"fontSize",themeKey:"typography"}),l({prop:"fontStyle",themeKey:"typography"}),l({prop:"fontWeight",themeKey:"typography"}),l({prop:"letterSpacing"}),l({prop:"lineHeight"}),l({prop:"textAlign"})),R=r("Ff2n"),T=r("q1tI"),D=r.n(T),A=r("iuhU"),I=r("2mql"),k=r.n(I),_=r("RD7I");function z(e,t){var r={};return Object.keys(e).forEach((function(n){-1===t.indexOf(n)&&(r[n]=e[n])})),r}var L=r("cNwE"),U=function(e){var t=function(e){return function(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.name,i=Object(R.a)(n,["name"]),s=a,c="function"===typeof t?function(e){return{root:function(r){return t(Object(o.a)({theme:e},r))}}}:{root:t},p=Object(_.a)(c,Object(o.a)({Component:e,name:a||e.displayName,classNamePrefix:s},i));t.filterProps&&(r=t.filterProps,delete t.filterProps),t.propTypes&&(t.propTypes,delete t.propTypes);var u=D.a.forwardRef((function(t,n){var a=t.children,i=t.className,s=t.clone,c=t.component,u=Object(R.a)(t,["children","className","clone","component"]),l=p(t),d=Object(A.a)(l.root,i),f=u;if(r&&(f=z(f,r)),s)return D.a.cloneElement(a,Object(o.a)({className:Object(A.a)(a.props.className,d)},f));if("function"===typeof a)return a(Object(o.a)({className:d},f));var m=c||e;return D.a.createElement(m,Object(o.a)({ref:n,className:d},f),a)}));return k()(u,e),u}}(e);return function(e,r){return t(e,Object(o.a)({defaultTheme:L.a},r))}},B=i(s(f,m,h,g,b,y,v,P,S.b,K)),F=U("div")(B,{name:"MuiBox"});t.a=F},v1CL:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/add-post",function(){return r("4VTM")}])}},[["v1CL",0,1,9,2,3,4,5,6,7,8,10,11]]]);