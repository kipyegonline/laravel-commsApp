_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[28],{"27FL":function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/issues",function(){return n("dIDr")}])},dIDr:function(e,t,n){"use strict";n.r(t);var s=n("ODXe"),a=n("q1tI"),r=n.n(a),u=n("EVdn"),i=n.n(u),c=n("vDqi"),d=n.n(c),l=n("7Cbv"),o=n("/MKj"),m=n("tRbT"),f=n("R/WZ"),p=n("hlFM"),h=n("Z3vd"),v=n("ADg1"),g=n("Spdj"),b=n("r9w1"),j=n("eD//"),y=n("tVbE"),I=n("IsqK"),w=n("56Ss"),N=n("3Qh7"),O=n("l1im"),_=n("L6Je"),x=n("t6oH"),E=(n("7pcq"),n("lMTm")),S=n("tm1B"),D=n("9jvC"),T=r.a.createElement,k=Object(f.a)({form:{padding:"1rem",margin:"1rem 0",maxWidth:500,background:"#fff"}}),C=5;var R=function(e){var t=e.sendValue,n=void 0===t?function(e){return e}:t,a=e.userdept,u=void 0===a?{}:a,c=e.sendSelected,d=void 0===c?function(e){return e}:c,o=r.a.useState(""),m=Object(s.a)(o,2),f=m[0],p=m[1],j=r.a.useState(""),y=Object(s.a)(j,2),I=y[0],w=y[1],N=r.a.useState(""),O=Object(s.a)(N,2),_=O[0],x=O[1],E=k(),S=r.a.useRef(null),D=r.a.useRef(null);return T("div",null,T("form",{className:E.form,ref:S,onSubmit:function(e){e.preventDefault(),u.id?f.trimRight().length<5?(w("Please type the issue"),setTimeout((function(){return w("")}),3e3)):f.trimRight().length>4&&u.id.length>0&&(D.current.disabled=!0,n({issue:f,altId:Object(l.a)(),userdept:u.id}),i.a.ajax({url:"./server/issues/issues.php?addissue=true",data:{issue:f,altId:Object(l.a)(),userdept:u.id},type:"POST",dataType:"json"}).then((function(e){if(d(""),200!==e.status)throw new Error(e.msg);x(e.msg),p(""),setTimeout((function(){S.current.reset(),x(""),D.current.disabled=!1}),2e3)})).catch((function(e){D.current.disabled=!1,w(e.message)}))):(w("Please click on the department"),setTimeout((function(){return w("")}),3e3))}},T("p",null,"Add issues for ",u.altName||""," department"),T(v.a,null,T(g.a,{className:"text-danger my-2"},u.altName||""," "),T(b.a,{label:"Add issue(s)",autoFocus:!0,onChange:function(e){return p(e.target.value)},value:f,variant:"outlined"})),T("div",{className:"form-group"},T(g.a,{error:!0,className:"my-1"},I),T(g.a,{className:"my-1 text-success"},_)),T(h.a,{color:"secondary",type:"submit",size:"medium",variant:"contained",ref:D},"Add Issue")))},V=function(e){var t=e.issues,n=void 0===t?[]:t,a=e.deleteId,u=void 0===a?function(e){return e}:a,i=r.a.useState(0),c=Object(s.a)(i,2),d=c[0],l=c[1],o=Math.ceil(n.length/10),m=10*d,f=10*d+10;return T(r.a.Fragment,null,T(j.a,{dense:!0},n.slice(m,f).map((function(e,t){return T(y.a,{key:e.altId,divider:!0,alignItems:"flex-start"},T("small",null,m+t+1),T(I.a,{primary:e.issue,secondary:e.altId}),T(w.a,null,T(N.a,{onClick:function(){return t=e.altId,void(confirm("Delete items?")&&(u(t),fetch("./server/issues/issues.php?deleteissue=true&id=".concat(t)).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return e}))));var t}})))}))),T(O.a,{count:o,defaultValue:d+1,color:"primary",onChange:function(e,t){return l(t-1)},className:"my-2"}))};t.default=function(){var e=Object(o.b)(),t=(k(),r.a.useState({})),n=Object(s.a)(t,2),a=n[0],u=n[1],i=Object(o.c)((function(e){return{issues:e.issues.addedIssues,departments:e.departments.departments}})),c=i.issues,l=i.departments;return r.a.useEffect((function(){d.a.get("./server/issues/issues.php?fetchissues=true").then((function(t){return e(E.b(t.data))})).catch((function(e){return console.log(e,"fetch error")})),e(S.d(C)),e(E.h(C))}),[]),T(_.a,null,T(m.a,{alignItems:"flex-start",container:!0,justify:"space-evenly",spacing:4,direction:"row"},T(m.a,{cols:5,item:!0,component:"div",xs:!0},T(R,{sendValue:function(t){e(E.d(t)),Object(D.b)(t,"issues")},userdept:a})),T(m.a,{item:!0,xs:!0},T(x.b,{depts:l,getDept:function(t){u(t),e(S.d(t.id)),e(E.h(t.id))}})),T(m.a,{item:!0,xs:!0},T(p.a,null,T("small",{className:"alert alert-primary text-center p-2 my-2"},a.department||""),T(V,{issues:c,deleteId:function(t){d.a.get("./server/issues/issues.php?deleteIssue=true&id=".concat(t)),e(E.f(t))}}),l.length?T(h.a,{variant:"outlined",color:"secondary",onClick:function(){return e(E.g())}},"View all issues"):null))))}}},[["27FL",0,1,9,2,3,4,5,6,7,8,10,11,15]]]);