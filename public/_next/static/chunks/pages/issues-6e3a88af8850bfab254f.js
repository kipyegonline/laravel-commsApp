_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[28],{"27FL":function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/issues",function(){return n("dIDr")}])},dIDr:function(e,t,n){"use strict";n.r(t);var a=n("ODXe"),r=n("q1tI"),s=n.n(r),u=n("EVdn"),i=n.n(u),l=n("vDqi"),o=n.n(l),c=n("7Cbv"),d=n("/MKj"),m=n("tRbT"),f=n("R/WZ"),v=n("hlFM"),p=n("Z3vd"),g=n("ADg1"),h=n("Spdj"),b=n("r9w1"),y=n("eD//"),I=n("tVbE"),j=n("IsqK"),N=n("56Ss"),w=n("3Qh7"),O=n("l1im"),S=n("L6Je"),C=n("t6oH"),x=(n("7pcq"),n("lMTm")),k=n("tm1B"),D=n("9jvC"),E=s.a.createElement,_=Object(f.a)({form:{padding:"1rem",margin:"1rem 0",maxWidth:500,background:"#fff"}}),T=5;var V=function(e){var t=e.sendValue,n=void 0===t?function(e){return e}:t,r=e.userdept,u=void 0===r?{}:r,l=e.sendSelected,o=void 0===l?function(e){return e}:l,d=s.a.useState(""),m=Object(a.a)(d,2),f=m[0],v=m[1],y=s.a.useState(""),I=Object(a.a)(y,2),j=I[0],N=I[1],w=s.a.useState(""),O=Object(a.a)(w,2),S=O[0],C=O[1],x=_(),k=s.a.useRef(null),D=s.a.useRef(null);return E("div",null,E("form",{className:x.form,ref:k,onSubmit:function(e){e.preventDefault(),u.id?f.trimRight().length<5?(N("Please type the issue"),setTimeout((function(){return N("")}),3e3)):f.trimRight().length>4&&u.id.length>0&&(D.current.disabled=!0,n({issue:f,altId:Object(c.a)(),userdept:u.id}),i.a.ajax({url:"./server/issues/issues.php?addissue=true",data:{issue:f,altId:Object(c.a)(),userdept:u.id},type:"POST",dataType:"json"}).then((function(e){if(o(""),200!==e.status)throw new Error(e.msg);C(e.msg),v(""),setTimeout((function(){k.current.reset(),C(""),D.current.disabled=!1}),2e3)})).catch((function(e){D.current.disabled=!1,N(e.message)}))):(N("Please click on the department"),setTimeout((function(){return N("")}),3e3))}},E("p",null,"Add issues for ",u.altName||""," department"),E(g.a,null,E(h.a,{className:"text-danger my-2"},u.altName||""," "),E(b.a,{label:"Add issue(s)",autoFocus:!0,onChange:function(e){return v(e.target.value)},value:f,variant:"outlined"})),E("div",{className:"form-group"},E(h.a,{error:!0,className:"my-1"},j),E(h.a,{className:"my-1 text-success"},S)),E(p.a,{color:"secondary",type:"submit",size:"medium",variant:"contained",ref:D},"Add Issue")))},A=function(e){var t=e.issues,n=void 0===t?[]:t,r=e.deleteId,u=void 0===r?function(e){return e}:r,i=s.a.useState(0),l=Object(a.a)(i,2),o=l[0],c=l[1],d=Math.ceil(n.length/10),m=10*o,f=10*o+10;return E(s.a.Fragment,null,E(y.a,{dense:!0},n.slice(m,f).map((function(e,t){return E(I.a,{key:e.altId,divider:!0,alignItems:"flex-start"},E("small",null,m+t+1),E(j.a,{primary:e.issue,secondary:e.altId}),E(N.a,null,E(w.a,{onClick:function(){return t=e.altId,void(confirm("Delete items?")&&(u(t),fetch("./server/issues/issues.php?deleteissue=true&id=".concat(t)).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return e}))));var t}})))}))),E(O.a,{count:d,defaultValue:o+1,color:"primary",onChange:function(e,t){return c(t-1)},className:"my-2"}))};t.default=function(){var e=Object(d.b)(),t=(_(),s.a.useState({})),n=Object(a.a)(t,2),r=n[0],u=n[1],i=Object(d.c)((function(e){return{issues:e.issues.addedIssues,departments:e.departments.departments}})),l=i.issues,c=i.departments;return s.a.useEffect((function(){o.a.get("./server/issues/issues.php?fetchissues=true").then((function(t){return e(x.b(t.data))})).catch((function(e){return console.log(e,"fetch error")})),e(k.d(T)),e(x.h(T))}),[]),E(S.a,null,E(m.a,{alignItems:"flex-start",container:!0,justify:"space-evenly",spacing:4,direction:"row"},E(m.a,{cols:5,item:!0,component:"div",xs:!0},E(V,{sendValue:function(t){e(x.d(t)),Object(D.b)(t,"issues")},userdept:r})),E(m.a,{item:!0,xs:!0},E(C.b,{depts:c,getDept:function(t){u(t),e(k.d(t.id)),e(x.h(t.id))}})),E(m.a,{item:!0,xs:!0},E(v.a,null,E("small",{className:"alert alert-primary text-center p-2 my-2"},r.department||""),E(A,{issues:l,deleteId:function(t){o.a.get("./server/issues/issues.php?deleteIssue=true&id=".concat(t)),e(x.f(t))}}),c.length?E(p.a,{variant:"outlined",color:"secondary",onClick:function(){return e(x.g())}},"View all issues"):null))))}},t6oH:function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return I})),n.d(t,"a",(function(){return j}));var a=n("ODXe"),r=n("q1tI"),s=n.n(r),u=n("ADg1"),i=n("1AYd"),l=n("cVXz"),o=n("jjAL"),c=n("ofer"),d=n("eD//"),m=n("tVbE"),f=n("IsqK"),v=(n("pdwK"),n("R/WZ")),p=n("l1im"),g=s.a.createElement,h=Object(v.a)({formControl:{width:"80%",margin:".5rem auto"}}),b=20;t.d=function(e){var t=e.issues,n=void 0===t?[]:t,r=e.getIssue,c=void 0===r?function(e){return e}:r,d=e.issue,m=void 0===d?"":d,f=e.multiple,v=void 0!==f&&f,p=s.a.useState(!0),b=Object(a.a)(p,2),y=b[0],I=b[1],j=h();return g(u.a,{className:j.formControl},g(i.a,{id:"issues-at-hand"},"Select Issue"),g(l.a,{labelId:"issues-at-hand",id:"issues-at-hand",value:m,variant:"filled",error:y,multiple:v,onChange:function(e){v?e.target.value.includes("")||(c(e.target.value),I(!1)):e.target.value.length>0&&(c(e.target.value),I(!1))}},g(o.a,{value:""},g("em",null,"Select Issue")),n.map((function(e){return g(o.a,{key:e.altId,value:e.id}," ",e.issue)}))))};var y=function(e){var t=e.depts,n=void 0===t?[]:t,r=e.getDept,u=void 0===r?function(e){return e}:r,i=s.a.useState(0),l=Object(a.a)(i,2),o=l[0],v=l[1],h=Math.ceil(n.length/10),b=10*o,y=10*o+10;return g(s.a.Fragment,null,g(c.a,{className:"mx-auto text-center alert alert-info my-2"},n.length," departments"),g(d.a,null,n.slice(b,y).map((function(e,t){return g(m.a,{key:e.id,dense:!0,alignItems:"center",selected:!0,className:e.selected?"bg-danger text-white":"bg-light",divider:!0,button:!0,onClick:function(){return u(e)}},g("small",{className:"mr-2"},b+t+1,". ")," ",g(f.a,{primary:e.department}))}))),n.length>10?g(p.a,{count:h,defaultValue:o+1,color:"primary",onChange:function(e,t){return v(t-1)},className:"my-2"}):null)},I=function(e){var t=e.users,n=void 0===t?[]:t,a=e.getUser,r=void 0===a?function(e){return e}:a;return g(d.a,{dense:!0},n.map((function(e,t){return g(m.a,{key:e.id,alignItems:"center",divider:!0,button:!0,onClick:function(){return r(e)},className:e.selected?"bg-info text-white":"bg-light",variant:"contained",color:"secondary"},g("small",{className:"mr-2"},t+1,". ")," ",g(f.a,{primary:e.username,secondary:e.usertitle+" - "+e.userphone}))})))};function j(e){var t=e.users,n=void 0===t?[]:t,r=e.getUser,c=void 0===r?function(e){return e}:r,d=e.user,m=void 0===d?"":d,f=e.multiple,v=void 0!==f&&f,p=s.a.useState(!0),y=Object(a.a)(p,2),I=y[0],j=y[1],N=h();return g(u.a,{className:N.formControl},g(i.a,{id:"user-at-hand"},"Select Colleauge"),g(l.a,{labelId:"user-at-hand",id:"issues-at-hand",value:m,variant:"filled",error:I,multiple:v,onChange:function(e){e.target.value.length>0&&(c(e.target.value),j(!1))}},g(o.a,{value:""},g("em",null,"Select Colleauge")),n.filter((function(e){return+e.id!==b})).map((function(e){return g(o.a,{key:e.altId,value:e.id},e.username)}))))}}},[["27FL",0,1,9,2,3,4,5,6,7,8,10,11,15]]]);