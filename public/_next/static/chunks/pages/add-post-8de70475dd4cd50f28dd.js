_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[23],{"4VTM":function(e,t,r){"use strict";r.r(t);var n=r("KQm4"),o=r("rePB"),a=r("ODXe"),i=r("q1tI"),s=r.n(i),c=r("/MKj"),p=r("R/WZ"),u=r("EVdn"),l=r.n(u),d=r("7Cbv"),f=r("tRbT"),m=r("ADg1"),h=r("1AYd"),g=r("pdwK"),y=r("r9w1"),b=r("Spdj"),v=r("Z3vd"),j=r("30+C"),O=r("iae6"),w=r("ofer"),x=r("ZiQX"),N=r("hlFM"),C=r("LYUY"),S=Object(C.a)(s.a.createElement("path",{d:"M12 7c-.55 0-1 .45-1 1v3H8c-.55 0-1 .45-1 1s.45 1 1 1h3v3c0 .55.45 1 1 1s1-.45 1-1v-3h3c.55 0 1-.45 1-1s-.45-1-1-1h-3V8c0-.55-.45-1-1-1zm0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"AddCircleOutlineRounded"),E=r("L6Je"),P=r("t6oH"),K=r("5jqn"),R=r("tm1B"),T=r("lMTm"),A=r("SBsC"),D=(r("9jvC"),s.a.createElement);function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){Object(o.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var z=Object(p.a)({grid:{minWidth:300},root:{width:"90%",margin:".5rem auto",border:"1px solid red",padding:"1rem"},textarea:{width:"80",margin:"1rem auto",borderRadius:10},formControl:{width:"100%"},input:{padding:"0.15rem",width:"100%",margin:"0.25rem 0.15rem"}}),B=20;t.default=function(){var e=s.a.useState(""),t=Object(a.a)(e,2),r=t[0],o=t[1],i=s.a.useState(""),p=Object(a.a)(i,2),u=p[0],C=p[1],k=s.a.useState(""),L=Object(a.a)(k,2),U=L[0],F=L[1],M=s.a.useState(""),V=Object(a.a)(M,2),H=V[0],W=V[1],q=s.a.useState(""),Y=Object(a.a)(q,2),G=Y[0],X=Y[1],J=s.a.useState([]),Q=Object(a.a)(J,2),Z=Q[0],$=Q[1],ee=s.a.useState([]),te=Object(a.a)(ee,2),re=te[0],ne=te[1],oe=s.a.useState(""),ae=Object(a.a)(oe,2),ie=ae[0],se=ae[1],ce=s.a.useState([]),pe=Object(a.a)(ce,2),ue=pe[0],le=pe[1],de=s.a.useState(""),fe=Object(a.a)(de,2),me=fe[0],he=fe[1],ge=s.a.useState(""),ye=Object(a.a)(ge,2),be=ye[0],ve=ye[1],je=s.a.useRef(null),Oe=s.a.useRef(null),we=Object(c.c)((function(e){return{issues:e.issues.fetched,selectedUsers:e.users.selectedUsers,departments:e.departments.departments,depterr:e.departments.errorMsg}})),xe=we.issues,Ne=we.selectedUsers,Ce=we.departments,Se=we.depterr,Ee=Object(c.b)(),Pe=z(),Ke=new Date;s.a.useEffect((function(){if(console.log("Effect, client Dept"),!Ce.length&&!xe.length)return Object(A.a)("/departments/fetchdepts",Ee),function(){console.log("unmounting"),R.e()}}),[]);var Re=[];return D(E.a,null,D(N.a,{className:Pe.root},D("form",{className:"form",ref:je,onSubmit:function(e){if(e.preventDefault(),r.trim().length<6)he("Kindly add a client or company name");else if(Z.length<1)he("Kindly select the nature of issue");else if(ie.trim().length<6)he("Kindly add the subject of the issue");else if(G.trim().length<10)he("Kindly provide a brief description of the issue");else if(ue.length<1)he("Please click on  the department to handle issue");else if(re.length<1)he("Please click on the officer(s) to handle issue");else if(r.trim().length>5&&Z.length>0&&ie.trim().length>5&&G.trim().length>9&&ue.length>0&&re.length>0){he(""),Oe.current.disabled=!0,function(e,t){e.forEach((function(e){var r=t.find((function(t){return t.userdept===e.userdept}));if(r){var o=e.id+"-"+r.id;Re=[].concat(Object(n.a)(Re),[I(I({},e),{},{id:o})])}}))}(re,xe);var t={clientName:r,clientPhone:u,clientEmail:U,clientOrg:H,message:G,handler:Re.map((function(e){return e.id})).join("*"),subject:ie,clientDept:ue.join("*"),addedBy:B,status:0,altId:Object(d.a)(),addedon:(new Date).toLocaleString()};console.log("dara",Re,t),l.a.ajax({url:"./server/posts/posts.php?addposts=true",dataType:"json",cache:!1,type:"post",data:t}).then((function(e){if(console.log("res",e),200!==e.status)throw new Error(e.msg);ve(e.msg),setTimeout((function(){Ee(K.j([])),Ee(R.e([])),Ee(T.k([])),ve(),o(""),C(""),F(""),W(""),X(""),$([]),ne([]),se(""),le([]),Re=[],je.current.reset(),Oe.current.disabled=!1}),2e3)})).catch((function(e){Oe.current.disabled=!1,console.log("BBC",e,e.statusText,e.message)}))}else he("Kindly ensure name,type of issue,subject,message,department and officer in-charge fields are not empty")}},D("h5",{className:"text-center alert alert-info p-2 my-2"},"Add new issue - ",Ke.toDateString()),D(f.a,{container:!0,justify:"space-evenly",alignItems:"flex-start"},D(f.a,{item:!0,xs:!0,className:"my-3 p-2 card w-100 ".concat(Pe.grid),style:{border:"1px solid yellow"}},D("p",{className:"text-center"},"Customer details"),D(m.a,{className:Pe.formControl},D(h.a,{htmlFor:"client-name"},"Enter Name"),D(g.a,{type:"text",onChange:function(e){return o(e.target.value)},id:"client-name",variant:"outlined"})),D(m.a,{className:Pe.formControl},D(h.a,{htmlFor:"client-phone"},"Enter Phone"),D(g.a,{type:"telephone",onChange:function(e){return C(e.target.value)},id:"client-phone",variant:"outlined",className:Pe.input})),D(m.a,{className:Pe.formControl},D(h.a,{htmlFor:"client"},"Enter email"),D(g.a,{type:"email",onChange:function(e){return F(e.target.value)},id:"client-email",label:"Enter email",className:Pe.input,variant:"outlined"})),D(m.a,{className:Pe.formControl},D(h.a,{htmlFor:"client"},"Enter Organisation"),D(g.a,{type:"text",onChange:function(e){return W(e.target.value)},id:"client-org",label:"Organisation",variant:"outlined",className:Pe.input})),xe.length>0?D(P.d,{getIssue:function(e){if(e.length>Z.length){var t=e[e.length-1],r=xe.find((function(e){return e.id===t}));if(r)xe.some((function(e){return e.userdept===r.userdept&&e.selected}))?alert("Cannot select 2 issues from same department, split the post into 2"):(Ee(T.e(t)),$(e))}else Z.forEach((function(t){e.indexOf(t)<0&&Ee(T.j(t.id))})),$(e)},issue:Z,issues:xe,multiple:!0}):null,D(y.a,{label:"subject",variant:"outlined",onChange:function(e){return se(e.target.value)},fullWidth:!0,className:Pe.textarea}),D(y.a,{variant:"outlined",label:"Add Description",onChange:function(e){return X(e.target.value)},rows:3,size:"medium",focused:!0,fullWidth:!0,multiline:!0,className:Pe.textarea}),D(b.a,{error:!0},me),D(b.a,{className:"alert alert-success"},be),D(v.a,{color:"primary",size:"large",variant:"outlined",type:"submit",ref:Oe,startIcon:D(S,null)},"Post Issue")),D(f.a,{item:!0,xs:!0,className:Pe.grid},Ce.length?D("div",null,D(P.b,{depts:Ce,getDept:function(e){if(ue.includes(e.id))ue.splice(ue.indexOf(e.id),1);else{var t=e.id;le([].concat(Object(n.a)(ue),[t]))}var r=e.selected;Ee(R.c(e.id)),r?(Ee(K.i(e.id)),Ee(T.i(e.id)),ne(re.filter((function(t){return t.userdept!==e.id})))):(function(e){fetch("./server/users/users.php?fetchSelectedUsers=true&id=".concat(e)).then((function(e){return e.json()})).then((function(e){if(e.length>0)return e.map((function(e){return I(I({},e),{},{selected:!1})}));throw new Error("No payload")})).then((function(e){return Ee(K.e(e))})).catch((function(e){return console.log("fetch users error",e)}))}(e.id),function(e){fetch("./server/issues/issues.php?fetchSelectedIssue=true&id=".concat(e)).then((function(e){return e.json()})).then((function(e){if(e.length>0){var t=e.map((function(e){return I(I({},e),{},{selected:!1})}));Ee(T.c(t))}throw new Error("No payload")})).catch((function(e){return console.log("fetch issue error",e)}))}(e.id))}}),D(j.a,null,D("small",null,"Selected departments"),D(_,{depts:Ce}))):Se?D("div",{className:"mx-auto my-4 p-4 text-center"},D(x.a,{severity:"warning"},D("p",null,Se))):D("div",{className:"mx-auto my-4 p-4 text-center"},D(O.a,{color:"primary",size:"3rem"}),D(w.a,null,"Loading departments"))),D(f.a,{item:!0,xs:!0,className:Pe.grid},Ne.length>0?D(P.c,{users:Ne,getUser:function(e){if(re.find((function(t){return t.id===e.id}))){var t=re.findIndex((function(t){return t.id===e.id}));re.splice(t,1),Ee(K.g(e.id))}else{re.some((function(t){return t.userdept===e.userdept}))?alert("Cannot add 2 users from the same department"):(ne([].concat(Object(n.a)(re),[e])),Ee(K.g(e.id)))}}}):D("p",{className:"text-center"},"Click on department to load users"))))))};var _=function(e){return e.depts.filter((function(e){return e.selected})).map((function(e,t){return D(b.a,{key:e.id},t+1,".",e.altName)}))}},"7Cbv":function(e,t,r){"use strict";var n="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),o=new Uint8Array(16);function a(){if(!n)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(o)}for(var i=[],s=0;s<256;++s)i.push((s+256).toString(16).substr(1));var c=function(e,t){var r=t||0,n=i;return(n[e[r+0]]+n[e[r+1]]+n[e[r+2]]+n[e[r+3]]+"-"+n[e[r+4]]+n[e[r+5]]+"-"+n[e[r+6]]+n[e[r+7]]+"-"+n[e[r+8]]+n[e[r+9]]+"-"+n[e[r+10]]+n[e[r+11]]+n[e[r+12]]+n[e[r+13]]+n[e[r+14]]+n[e[r+15]]).toLowerCase()};t.a=function(e,t,r){"string"===typeof e&&(t="binary"===e?new Uint8Array(16):null,e=null);var n=(e=e||{}).random||(e.rng||a)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){for(var o=r||0,i=0;i<16;++i)t[o+i]=n[i];return t}return c(n)}},LYUY:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("wx14"),o=r("q1tI"),a=r.n(o),i=r("HR5l");function s(e,t){var r=a.a.memo(a.a.forwardRef((function(t,r){return a.a.createElement(i.a,Object(n.a)({ref:r},t),e)})));return r.muiName=i.a.muiName,r}},SBsC:function(e,t,r){"use strict";var n=r("o0o1"),o=r.n(n),a=r("HaE+"),i=r("vDqi"),s=r.n(i),c=r("tm1B");function p(){return(p=Object(a.a)(o.a.mark((function e(t,r){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.a.get(t);case 3:if(!(null===(a=e.sent)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.length)&&!Array.isArray(a.data)){e.next=8;break}r(c.a),e.next=9;break;case 8:throw new Error("No data found...");case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),r(c.f(e.t0.message));case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}t.a=function(e,t){return p.apply(this,arguments)}},hlFM:function(e,t,r){"use strict";var n=r("KQm4"),o=r("wx14"),a=(r("17x9"),r("bv9d"));var i=function(e){var t=function(t){var r=e(t);return t.css?Object(o.a)(Object(o.a)({},Object(a.a)(r,e(Object(o.a)({theme:t.theme},t.css)))),function(e,t){var r={};return Object.keys(e).forEach((function(n){-1===t.indexOf(n)&&(r[n]=e[n])})),r}(t.css,[e.filterProps])):r};return t.propTypes={},t.filterProps=["css"].concat(Object(n.a)(e.filterProps)),t};var s=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=function(e){return t.reduce((function(t,r){var n=r(e);return n?Object(a.a)(t,n):t}),{})};return n.propTypes={},n.filterProps=t.reduce((function(e,t){return e.concat(t.filterProps)}),[]),n},c=r("rePB"),p=r("LybE");function u(e,t){return t&&"string"===typeof t?t.split(".").reduce((function(e,t){return e&&e[t]?e[t]:null}),e):null}var l=function(e){var t=e.prop,r=e.cssProperty,n=void 0===r?e.prop:r,o=e.themeKey,a=e.transform,i=function(e){if(null==e[t])return null;var r=e[t],i=u(e.theme,o)||{};return Object(p.a)(e,r,(function(e){var t;return"function"===typeof i?t=i(e):Array.isArray(i)?t=i[e]||e:(t=u(i,e)||e,a&&(t=a(t))),!1===n?t:Object(c.a)({},n,t)}))};return i.propTypes={},i.filterProps=[t],i};function d(e){return"number"!==typeof e?e:"".concat(e,"px solid")}var f=s(l({prop:"border",themeKey:"borders",transform:d}),l({prop:"borderTop",themeKey:"borders",transform:d}),l({prop:"borderRight",themeKey:"borders",transform:d}),l({prop:"borderBottom",themeKey:"borders",transform:d}),l({prop:"borderLeft",themeKey:"borders",transform:d}),l({prop:"borderColor",themeKey:"palette"}),l({prop:"borderRadius",themeKey:"shape"})),m=s(l({prop:"displayPrint",cssProperty:!1,transform:function(e){return{"@media print":{display:e}}}}),l({prop:"display"}),l({prop:"overflow"}),l({prop:"textOverflow"}),l({prop:"visibility"}),l({prop:"whiteSpace"})),h=s(l({prop:"flexBasis"}),l({prop:"flexDirection"}),l({prop:"flexWrap"}),l({prop:"justifyContent"}),l({prop:"alignItems"}),l({prop:"alignContent"}),l({prop:"order"}),l({prop:"flex"}),l({prop:"flexGrow"}),l({prop:"flexShrink"}),l({prop:"alignSelf"}),l({prop:"justifyItems"}),l({prop:"justifySelf"})),g=s(l({prop:"gridGap"}),l({prop:"gridColumnGap"}),l({prop:"gridRowGap"}),l({prop:"gridColumn"}),l({prop:"gridRow"}),l({prop:"gridAutoFlow"}),l({prop:"gridAutoColumns"}),l({prop:"gridAutoRows"}),l({prop:"gridTemplateColumns"}),l({prop:"gridTemplateRows"}),l({prop:"gridTemplateAreas"}),l({prop:"gridArea"})),y=s(l({prop:"position"}),l({prop:"zIndex",themeKey:"zIndex"}),l({prop:"top"}),l({prop:"right"}),l({prop:"bottom"}),l({prop:"left"})),b=s(l({prop:"color",themeKey:"palette"}),l({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette"})),v=l({prop:"boxShadow",themeKey:"shadows"});function j(e){return e<=1?"".concat(100*e,"%"):e}var O=l({prop:"width",transform:j}),w=l({prop:"maxWidth",transform:j}),x=l({prop:"minWidth",transform:j}),N=l({prop:"height",transform:j}),C=l({prop:"maxHeight",transform:j}),S=l({prop:"minHeight",transform:j}),E=(l({prop:"size",cssProperty:"width",transform:j}),l({prop:"size",cssProperty:"height",transform:j}),s(O,w,x,N,C,S,l({prop:"boxSizing"}))),P=r("+Hmc"),K=s(l({prop:"fontFamily",themeKey:"typography"}),l({prop:"fontSize",themeKey:"typography"}),l({prop:"fontStyle",themeKey:"typography"}),l({prop:"fontWeight",themeKey:"typography"}),l({prop:"letterSpacing"}),l({prop:"lineHeight"}),l({prop:"textAlign"})),R=r("Ff2n"),T=r("q1tI"),A=r.n(T),D=r("iuhU"),k=r("2mql"),I=r.n(k),z=r("RD7I");function B(e,t){var r={};return Object.keys(e).forEach((function(n){-1===t.indexOf(n)&&(r[n]=e[n])})),r}var _=r("cNwE"),L=function(e){var t=function(e){return function(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.name,i=Object(R.a)(n,["name"]),s=a,c="function"===typeof t?function(e){return{root:function(r){return t(Object(o.a)({theme:e},r))}}}:{root:t},p=Object(z.a)(c,Object(o.a)({Component:e,name:a||e.displayName,classNamePrefix:s},i));t.filterProps&&(r=t.filterProps,delete t.filterProps),t.propTypes&&(t.propTypes,delete t.propTypes);var u=A.a.forwardRef((function(t,n){var a=t.children,i=t.className,s=t.clone,c=t.component,u=Object(R.a)(t,["children","className","clone","component"]),l=p(t),d=Object(D.a)(l.root,i),f=u;if(r&&(f=B(f,r)),s)return A.a.cloneElement(a,Object(o.a)({className:Object(D.a)(a.props.className,d)},f));if("function"===typeof a)return a(Object(o.a)({className:d},f));var m=c||e;return A.a.createElement(m,Object(o.a)({ref:n,className:d},f),a)}));return I()(u,e),u}}(e);return function(e,r){return t(e,Object(o.a)({defaultTheme:_.a},r))}},U=i(s(f,m,h,g,y,b,v,E,P.b,K)),F=L("div")(U,{name:"MuiBox"});t.a=F},v1CL:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/add-post",function(){return r("4VTM")}])}},[["v1CL",0,1,10,2,3,4,5,6,7,8,9,11]]]);